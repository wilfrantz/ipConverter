CMAKE_MINIMUM_REQUIRED(VERSION 3.26)
PROJECT(ipconverter VERSION 0.0.1 LANGUAGES CXX)

SET(CMAKE_CXX_STANDARD 17)

# Find packages
find_package(PkgConfig REQUIRED)
pkg_search_module(JSONCPP REQUIRED jsoncpp)
link_libraries(${JSONCPP_LIBRARIES})
FIND_PACKAGE(spdlog REQUIRED)
FIND_PACKAGE(jsoncpp REQUIRED)

# FIND_LIBRARY(FMT_LIB NAMES fmt fmtd)

if (UNIX AND NOT APPLE)
    set(jsoncpp_DIR "/usr/lib/x86_64-linux-gnu/cmake/jsoncpp/")
elseif (APPLE)
    set(jsoncpp_DIR "/usr/local/opt/jsoncpp/lib/cmake/jsoncpp/")
endif()

OPTION(CMAKE_VERBOSE_MAKEFILE "Verbose Makefile" ON)
OPTION(BUILD_TESTS "Build tests" ON)

ADD_COMPILE_DEFINITIONS(ENGINE_VERSION="${PROJECT_VERSION}")

ADD_EXECUTABLE("${PROJECT_NAME}"
  src/main.cpp
  src/ip_converter.cpp
  src/ip_address_converter.cpp
)

TARGET_LINK_LIBRARIES("${PROJECT_NAME}" PRIVATE
  ${CURL_LIBRARIES}
  ${BOOST_LIBRARIES}
  # ${JSONCPP_LIBRARIES}
  # ${FMT_LIB}
  ${SPDLOG_LIBRARIES}
  jsoncpp
)

TARGET_INCLUDE_DIRECTORIES("${PROJECT_NAME}"
  PRIVATE
  ${JSONCPP_INCLUDE_DIRS}
)

# IF (BUILD_TESTS)
#   MESSAGE(STATUS "Building tests ...")
#   ENABLE_TESTING()
#   ADD_SUBDIRECTORY(test)
#   ADD_TEST(NAME ${PROJECT_NAME}_tests COMMAND test/${PROJECT_NAME}_test)
# ENDIF (BUILD_TESTS)
